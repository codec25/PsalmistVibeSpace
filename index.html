<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PSALMIST VIBES // MUSICVERSE_PORTAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #010204; 
            --panel: rgba(10, 14, 23, 0.9); 
            --blue: #4facfe; 
            --gold: #ffcc00; 
            --border: #1e2544; 
            --green: #00ff88; 
            --red: #ff4b2b; 
        }

        * { box-sizing: border-box; }

        body { 
            margin: 0; background: var(--bg); color: #fff; font-family: 'Orbitron', sans-serif; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh;
            background-image: radial-gradient(circle at 50% 50%, #0a1324 0%, #010204 100%);
            padding: 40px 20px;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        /* Sonic Launch Overlay */
        #launch-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, var(--blue) 0%, transparent 70%);
            opacity: 0; pointer-events: none; z-index: 10000;
            transition: 0.4s;
        }

        .academy-title { text-align: center; margin-bottom: 50px; }
        .academy-title h1 { font-size: clamp(2rem, 6vw, 4rem); letter-spacing: 12px; margin: 0; text-shadow: 0 0 20px rgba(0,255,136,0.2); }
        .academy-title p { font-size: 0.8rem; letter-spacing: 5px; color: var(--green); text-transform: uppercase; }

        .portal-wrapper { display: flex; gap: 40px; width: 100%; max-width: 1100px; flex-wrap: wrap; justify-content: center; transition: 0.5s; }

        .card {
            background: var(--panel); border: 1px solid var(--border); border-radius: 24px; 
            padding: 40px; width: 420px; text-align: center; backdrop-filter: blur(15px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .card.ninja-card { border-top: 4px solid var(--green); }
        .card.teacher-card { border-top: 4px solid var(--blue); }

        input {
            width: 100%; padding: 14px; background: rgba(0,0,0,0.5); border: 1px solid var(--border);
            color: #fff; border-radius: 10px; font-family: 'Orbitron'; margin-bottom: 12px; text-align: center;
        }

        .btn {
            width: 100%; padding: 18px; border: none; border-radius: 12px; font-family: 'Orbitron';
            font-weight: 900; cursor: pointer; transition: 0.3s; text-transform: uppercase; letter-spacing: 2px;
        }

        .btn-ninja { background: var(--green); color: #000; margin-bottom: 10px; }
        .btn-teacher { background: var(--blue); color: #000; }
        .btn-guest { background: transparent; color: #666; border: 1px solid #333; font-size: 0.7rem; }

        .err-msg { color: var(--red); font-size: 0.6rem; margin-top: 10px; display: none; }

        /* Sonic Expansion Animation */
        .sonic-launch { transform: scale(1.5); filter: brightness(2) blur(5px); opacity: 0; }
    </style>
</head>
<body>

    <div id="launch-overlay"></div>

    <script>
        // --- GLOBAL LOCK CHECK ---
        if (localStorage.getItem('global_system_lock') === 'true') {
            document.body.innerHTML = `
                <div style="background:#000; color:#ff4b2b; height:100vh; width:100vw; display:flex; flex-direction:column; align-items:center; justify-content:center; font-family:Orbitron,sans-serif; text-align:center; padding:20px; position:fixed; top:0; left:0; z-index:9999;">
                    <h1 style="letter-spacing:10px; font-size:3rem; margin:0;">SYSTEM_LOCKED</h1>
                    <p style="color:#888; font-size:0.8rem; letter-spacing:3px;">THE ARCHITECT HAS SUSPENDED ALL SECTORS FOR MAINTENANCE.</p>
                </div>`;
            window.stop();
        }
    </script>

    <div class="academy-title">
        <h1>PSALMIST VIBES</h1>
        <p>M U S I C V E R S E _ P O R T A L</p>
    </div>

    <div class="portal-wrapper" id="portal-ui">
        <div class="card ninja-card">
            <h2 style="letter-spacing: 6px;">NINJA</h2>
            <input type="text" id="n-id" placeholder="NINJA_ID">
            <input type="password" id="n-pass" placeholder="PASSWORD">
            <button class="btn btn-ninja" onclick="loginNinja()">INITIALIZE_SESSION</button>
            <button class="btn btn-guest" onclick="launchGuest()">GUEST_ACCESS</button>
            <div id="n-err" class="err-msg">INVALID_CREDENTIALS</div>
        </div>

        <div class="card teacher-card">
            <h2 style="letter-spacing: 6px;">TEACHER</h2>
            <input type="text" id="t-id" placeholder="SENSEI_ID">
            <input type="password" id="t-pass" placeholder="ACCESS_KEY">
            <button class="btn btn-teacher" onclick="loginTeacher()">DECRYPT_VAULT</button>
            <div id="t-err" class="err-msg">UNAUTHORIZED_FREQUENCY</div>
        </div>
    </div>

    <script>
        // --- KEYBOARD LISTENERS ---
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                if (document.activeElement.id.startsWith('t-')) {
                    loginTeacher();
                } else {
                    loginNinja();
                }
            }
        });

        // --- MUSICVERSE TRANSITION ---
        function musicverseTransition(url) {
            document.getElementById('portal-ui').classList.add('sonic-launch');
            document.getElementById('launch-overlay').style.opacity = '1';
            setTimeout(() => {
                window.location.href = url;
            }, 500);
        }

        function loginNinja() {
            const id = document.getElementById('n-id').value.trim();
            const pass = document.getElementById('n-pass').value.trim();
            const storedPass = localStorage.getItem(`pass_${id}`);
            const isLocked = localStorage.getItem(`lock_${id}`) === "true";

            if (isLocked) {
                document.getElementById('n-err').innerText = "ACCOUNT_LOCKED_BY_SENSEI";
                document.getElementById('n-err').style.display = "block";
                return;
            }

            if (storedPass && storedPass === pass) {
                localStorage.setItem('ninjaUser', id);
                localStorage.setItem('isGuest', 'false');
                musicverseTransition('hub.html');
            } else {
                document.getElementById('n-err').innerText = "INVALID_CREDENTIALS";
                document.getElementById('n-err').style.display = "block";
            }
        }

        function launchGuest() {
            const guestID = "GUEST_" + Math.floor(Math.random() * 999);
            localStorage.setItem('ninjaUser', guestID);
            localStorage.setItem('isGuest', 'true');
            localStorage.setItem('totalXP', '0');
            musicverseTransition('hub.html');
        }

        function loginTeacher() {
            const id = document.getElementById('t-id').value.trim();
            const pass = document.getElementById('t-pass').value.trim();
            const db = JSON.parse(localStorage.getItem('psalmist_teachers')) || {};

            if (db[id]) {
                if (localStorage.getItem(`teacher_lock_${id}`) === "true") {
                    document.getElementById('t-err').innerText = "ACCOUNT_SUSPENDED_BY_IT";
                    document.getElementById('t-err').style.display = "block";
                    return;
                }
                if (db[id].password === pass) {
                    sessionStorage.setItem('currentTeacher', id);
                    musicverseTransition('teacher_dashboard.html');
                } else {
                    document.getElementById('t-err').style.display = "block";
                }
            } else {
                document.getElementById('t-err').innerText = "ACCOUNT_NOT_FOUND";
                document.getElementById('t-err').style.display = "block";
            }
        }
    </script>
</body>
</html>
