<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PSALMIST VIBES // NINJA_PORTAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #010204; --panel: rgba(7, 10, 17, 0.98); 
            --blue: #4facfe; --gold: #ffcc00; --border: #1e2544; 
            --green: #00ff88; --red: #ff4b2b; 
        }

        * { box-sizing: border-box; outline: none; }

        body { 
            margin: 0; background: var(--bg); color: #fff; font-family: 'Orbitron', sans-serif; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh;
            background-image: radial-gradient(circle at 50% 50%, #0a1324 0%, #010204 100%);
            overflow: hidden;
        }

        .portal-frame {
            width: 420px; padding: 60px 40px; background: var(--panel);
            border: 1px solid var(--border); border-radius: 40px;
            box-shadow: 0 0 60px rgba(0,0,0,0.9), inset 0 0 30px rgba(0, 255, 136, 0.05);
            text-align: center; position: relative; z-index: 10;
            backdrop-filter: blur(15px); transition: all 0.5s ease;
        }

        .musical-header { font-size: 1.5rem; color: var(--gold); margin-bottom: 10px; letter-spacing: 15px; opacity: 0.8; }
        h2 { font-size: 1.1rem; letter-spacing: 8px; margin-bottom: 40px; color: var(--green); transition: 0.4s; text-transform: uppercase; }

        .input-group { margin-bottom: 20px; text-align: left; position: relative; }
        .input-group label { display: block; font-size: 0.55rem; color: #444; margin-bottom: 8px; letter-spacing: 1px; }
        
        input {
            width: 100%; padding: 18px; background: rgba(0,0,0,0.8); border: 1px solid var(--border);
            color: var(--green); border-radius: 15px; font-family: 'Orbitron'; text-align: center;
            font-size: 0.85rem; transition: 0.3s;
        }
        input:focus { border-color: var(--green); box-shadow: 0 0 15px rgba(0, 255, 136, 0.2); }

        .toggle-pass {
            position: absolute; right: 15px; bottom: 15px; cursor: pointer;
            color: #444; font-size: 0.8rem; transition: 0.3s;
        }
        .toggle-pass:hover { color: var(--green); }

        .btn {
            width: 100%; padding: 20px; border: none; border-radius: 15px; font-family: 'Orbitron';
            font-weight: 900; cursor: pointer; transition: 0.4s; text-transform: uppercase;
            letter-spacing: 4px; margin-top: 15px;
        }

        .btn-main { background: var(--green); color: #000; }
        .btn-main:hover { background: #fff; transform: scale(1.02); }

        .sub-links { margin-top: 30px; display: flex; flex-direction: column; gap: 12px; }
        
        .link { 
            color: #444; font-size: 0.6rem; text-decoration: none; cursor: pointer; 
            letter-spacing: 2px; transition: 0.3s; text-transform: uppercase;
        }
        .link:hover { color: var(--gold); }
        
        .sensei-toggle { color: #2a3a5a; font-weight: bold; padding: 10px; border: 1px solid #111; border-radius: 10px; margin-top: 10px; }
        .sensei-toggle:hover { color: var(--blue); border-color: var(--blue); }
        .guest-link { color: var(--gold); border: 1px solid rgba(255,204,0,0.2); padding: 8px; border-radius: 8px; }
        .guest-link:hover { background: rgba(255,204,0,0.1); }

        #err-log { color: var(--red); font-size: 0.65rem; margin-top: 20px; display: none; font-weight: bold; text-shadow: 0 0 5px var(--red); }

        .floating-note {
            position: absolute; font-size: 1.5rem; color: rgba(0, 255, 136, 0.1);
            pointer-events: none; animation: floatUp 10s infinite linear; z-index: -1;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            100% { transform: translateY(-20vh) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="portal-frame" id="card">
        <div class="musical-header">‚ô© ‚ô™ ‚ô´ ‚ô¨</div>
        <h2 id="portal-title">NINJA_PORTAL</h2>
        
        <div class="input-group">
            <label>IDENTITY_CODE</label>
            <input type="text" id="u-id" placeholder="ENTER_ID" autocomplete="off">
        </div>
        <div class="input-group">
            <label>SECURITY_KEY</label>
            <input type="password" id="u-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            <span class="toggle-pass" onclick="togglePassView()">üëÅ</span>
        </div>

        <button class="btn btn-main" id="main-btn" onclick="executeAuth()">INITIALIZE</button>

        <div class="sub-links">
            <a class="link" onclick="requestHelp()" style="color: var(--red);">FORGOT_ID?_SIGNAL_SENSEI</a>
            <a class="link guest-link" onclick="guestEntry()">GUEST_ENTRY (TEMP)</a>
            <a class="link sensei-toggle" id="mode-toggle" onclick="toggleSenseiMode()">ARE YOU A SENSEI?</a>
        </div>

        <div id="err-log">ACCESS_DENIED // INVALID_CREDENTIALS</div>
    </div>

    <script>
        let isSenseiMode = false;

        // --- MASTER CONFIG ---
        const MASTER_ID = "ADMIN_1";
        const MASTER_PASS = "MASTER_ROOT_2026";
        const SOVEREIGN_KEY = "777"; // The key required to activate the shortcut injection

        function togglePassView() {
            const passInput = document.getElementById('u-pass');
            passInput.type = passInput.type === "password" ? "text" : "password";
        }

        function toggleSenseiMode() {
            isSenseiMode = !isSenseiMode;
            const title = document.getElementById('portal-title');
            const btn = document.getElementById('main-btn');
            
            title.innerText = isSenseiMode ? "SENSEI_VAULT" : "NINJA_PORTAL";
            title.style.color = isSenseiMode ? "var(--blue)" : "var(--green)";
            btn.innerText = isSenseiMode ? "DECRYPT_SENSEI" : "INITIALIZE";
            btn.style.background = isSenseiMode ? "var(--blue)" : "var(--green)";
        }

        function executeAuth() {
            const rawId = document.getElementById('u-id').value.trim();
            const passInput = document.getElementById('u-pass').value.trim();
            const id = rawId.toUpperCase();

            // 1. MASTER ADMIN BYPASS (Manual entry or post-shortcut)
            if (id === MASTER_ID && passInput === MASTER_PASS) {
                localStorage.setItem('it_active', 'true');
                localStorage.setItem('ninjaUser', id);
                localStorage.setItem('userType', 'ADMIN');
                window.location.href = 'it_manager.html';
                return;
            }

            // 2. LOAD DATABASES
            const vault = JSON.parse(localStorage.getItem('vault_users')) || { teachers: {}, AUDIT_LOG: [] };
            const ninjaRoster = JSON.parse(localStorage.getItem('ninja_roster_full')) || {};

            if (isSenseiMode) {
                const teacher = vault.teachers[id];
                if (teacher && teacher.pass === passInput && teacher.role !== "TERMINATED") {
                    localStorage.setItem('ninjaUser', id);
                    localStorage.setItem('userType', 'SENSEI');
                    localStorage.setItem('userRole', teacher.role);
                    window.location.href = 'sensei_dash.html';
                } else { 
                    logAudit(id, "SENSEI_AUTH_FAILED");
                    showError(); 
                }
            } else {
                if (ninjaRoster[id] && ninjaRoster[id].pass === passInput) {
                    localStorage.setItem('ninjaUser', id);
                    localStorage.setItem('userType', 'MEMBER');
                    window.location.href = 'hub.html';
                } else { 
                    showError(); 
                }
            }
        }

        function logAudit(user, status) {
            let vault = JSON.parse(localStorage.getItem('vault_users')) || { teachers: {}, AUDIT_LOG: [] };
            vault.AUDIT_LOG.unshift({ time: new Date().toLocaleString(), user: user, status: status });
            localStorage.setItem('vault_users', JSON.stringify(vault));
        }

        function guestEntry() {
            const guestID = "GUEST_" + Math.floor(1000 + Math.random() * 9000);
            localStorage.setItem('ninjaUser', guestID);
            localStorage.setItem('userType', 'GUEST');
            window.location.href = 'hub.html';
        }

        function showError() {
            const errorDiv = document.getElementById('err-log');
            const card = document.getElementById('card');
            errorDiv.style.display = "block";
            card.style.transform = "translateX(8px)";
            setTimeout(() => card.style.transform = "translateX(-8px)", 50);
            setTimeout(() => card.style.transform = "translateX(0)", 100);
            setTimeout(() => { errorDiv.style.display = "none"; }, 3000);
        }

        function requestHelp() {
            alert("EMERGENCY SIGNAL SENT TO SENSEI NETWORK.");
        }

        // --- KEYBOARD LISTENERS ---
        window.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                executeAuth();
            }
            
            // TACTICAL ADMIN OVERRIDE: Ctrl + Shift + L
            if (e.ctrlKey && e.shiftKey && e.key.toUpperCase() === 'L') {
                e.preventDefault();
                
                // SECURE GATE: Prompt for secondary key
                const challenge = prompt("AUTHORIZED_ACCESS_REQUIRED // ENTER_SOVEREIGN_KEY:");
                
                if (challenge === SOVEREIGN_KEY) {
                    // Visual Flash indicating success
                    document.getElementById('card').style.boxShadow = "0 0 50px var(--red)";
                    
                    // Inject Credentials
                    document.getElementById('u-id').value = MASTER_ID;
                    document.getElementById('u-pass').value = MASTER_PASS;
                    
                    // Automated Login
                    setTimeout(() => {
                        executeAuth();
                    }, 400);
                } else {
                    logAudit("SYSTEM", "UNAUTHORIZED_OVERRIDE_ATTEMPT");
                    console.warn("CRITICAL: Invalid Sovereign Key entered.");
                }
            }

            // Secret IT Shortcut: Ctrl + Shift + I
            if (e.ctrlKey && e.shiftKey && e.key.toUpperCase() === 'I') {
                window.location.href = 'it_vault.html';
            }
        });

        // Particle FX
        setInterval(() => {
            const notes = ['‚ô©', '‚ô™', '‚ô´', '‚ô¨'];
            const n = document.createElement('div');
            n.className = 'floating-note';
            n.innerText = notes[Math.floor(Math.random() * notes.length)];
            n.style.left = Math.random() * 100 + "vw";
            document.body.appendChild(n);
            setTimeout(() => n.remove(), 10000);
        }, 3000);
    </script>
</body>
</html>
