<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>THEORY_VAULT // 12-Grade Professional Syllabus</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #05070a; --gold: #ffcc00; --blue: #4facfe; 
            --border: #1e2544; --green: #00ff88; --red: #ff4b2b; 
        }
        body { 
            margin: 0; background: var(--bg); color: #fff; font-family: 'Orbitron', sans-serif; 
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
            background-image: radial-gradient(circle at center, #0b1426 0%, #05070a 100%);
        }
        
        /* --- Header HUD --- */
        .header-shield {
            width: 100%; background: rgba(10, 15, 25, 0.98); border-bottom: 1px solid var(--border);
            padding: 20px 0; position: sticky; top: 0; z-index: 100; display: flex; justify-content: center;
        }
        .header-content { width: 1100px; display: flex; justify-content: space-between; align-items: center; }
        .nav-link { color: var(--blue); text-decoration: none; font-size: 0.7rem; border: 1px solid var(--blue); padding: 5px 15px; }

        .grade-container { width: 1100px; margin-top: 40px; display: grid; grid-template-columns: 320px 1fr; gap: 40px; padding-bottom: 100px;}
        
        /* --- Sidebar --- */
        .grade-list { background: rgba(10, 14, 23, 0.8); border: 1px solid var(--border); border-radius: 4px; }
        .grade-item { 
            padding: 18px; border-bottom: 1px solid #111; cursor: pointer; transition: 0.2s; 
            font-size: 0.65rem; color: #666; display: flex; justify-content: space-between; align-items: center;
        }
        .grade-item.active { background: rgba(79, 172, 254, 0.1); color: var(--blue); border-left: 4px solid var(--blue); }
        .grade-item.locked { cursor: not-allowed; opacity: 0.4; }
        .grade-item:hover:not(.locked) { background: rgba(255,255,255,0.05); color: #fff; }

        /* --- Main Content Area --- */
        .content-area { background: #0a0e17; border: 1px solid var(--border); padding: 50px; border-radius: 4px; position: relative; }
        .lesson-text { color: #aaa; line-height: 1.8; font-size: 0.9rem; margin-bottom: 40px; }
        
        /* --- Quiz Logic --- */
        .quiz-box { border-top: 1px solid var(--border); padding-top: 30px; }
        .option-btn {
            display: block; width: 100%; padding: 16px; margin: 12px 0; background: rgba(255,255,255,0.02);
            border: 1px solid var(--border); color: #888; text-align: left; cursor: pointer; font-family: 'Orbitron';
            transition: 0.2s; font-size: 0.75rem;
        }
        .option-btn:hover { border-color: var(--blue); color: #fff; background: rgba(79, 172, 254, 0.05); }
        .option-btn.correct { border-color: var(--green); color: var(--green); background: rgba(0, 255, 136, 0.1); }
        .option-btn.wrong { border-color: var(--red); color: var(--red); background: rgba(255, 75, 43, 0.1); }

        .btn-proceed {
            background: var(--gold); color: #000; border: none; padding: 20px; width: 100%;
            font-family: 'Orbitron'; font-weight: 900; margin-top: 20px; cursor: pointer; 
            display: none; letter-spacing: 2px;
        }

        /* --- AI Research Bot --- */
        .ai-bot { margin-top: 40px; padding: 20px; border: 1px solid var(--blue); background: rgba(79,172,254,0.02); }
        #ai-output { font-size: 0.7rem; color: var(--blue); margin-top: 10px; min-height: 20px; }
    </style>
</head>
<body>

<div class="header-shield">
    <div class="header-content">
        <div style="font-weight: 900; letter-spacing: 5px;">THEORY_VAULT</div>
        <div id="user-stats" style="font-size: 0.7rem; color: var(--gold);">GRADE: 01 // XP: 0</div>
        <a href="hub.html" class="nav-link">COMMAND_CENTER</a>
    </div>
</div>

<div class="grade-container">
    <div class="grade-list" id="grade-sidebar"></div>

    <div class="content-area">
        <h1 id="lesson-title" style="margin-top:0; letter-spacing:2px;">INITIALIZING_VAULT...</h1>
        <div id="lesson-text" class="lesson-text"></div>
        
        <div id="quiz-section" class="quiz-box">
            <div id="question-text" style="font-weight:700; margin-bottom:20px; color:var(--blue);"></div>
            <div id="options-area"></div>
            <button id="btn-proceed" class="btn-proceed" onclick="completeGrade()">UNLOCK_NEXT_GRADE</button>
        </div>

        <div class="ai-bot">
            <div style="font-size: 0.6rem; letter-spacing: 2px;">AI_RESEARCH_BOT</div>
            <input type="text" id="ai-input" placeholder="Query the vault (e.g. 'What is a triplet?')" 
                   style="width:100%; background:none; border:none; border-bottom:1px solid var(--blue); color:#fff; padding:10px 0; outline:none; font-family:'Orbitron';">
            <div id="ai-output">Standing by for query...</div>
        </div>
    </div>
</div>

<script>
    const SYLLABUS = [
        {
            grade: 1, title: "THE_TACTUS", 
            text: "The Tactus is the fundamental beat. In Western music, the 4/4 time signature uses the Quarter Note as the primary pulse. Mastering the tactus means maintaining a consistent internal clock.",
            questions: [
                { q: "What is the primary unit of the Tactus in 4/4 time?", a: ["Quarter Note", "Eighth Note", "Whole Note"], correct: 0 },
                { q: "Which term describes a steady, underlying pulse?", a: ["Melody", "Tactus", "Dynamics"], correct: 1 }
            ]
        },
        {
            grade: 2, title: "SIMPLE_SUBDIVISION", 
            text: "Simple subdivision involves dividing the beat into two equal parts. In 4/4, one quarter note becomes two eighth notes. This is the foundation of rhythmic accuracy.",
            questions: [
                { q: "If a beat is divided into 2 equal parts, they are called:", a: ["Triplets", "Subdivisions", "Octaves"], correct: 1 },
                { q: "How many Eighth notes fit into a single 4/4 measure?", a: ["4", "8", "16"], correct: 1 }
            ]
        },
        {
            grade: 3, title: "TERNARY_GROUPING", 
            text: "Ternary grouping (Triplets) occurs when a beat is divided into three equal parts. This creates a 'rolling' feel compared to the 'straight' feel of simple subdivisions.",
            questions: [
                { q: "A 'Triplet' divides one beat into how many parts?", a: ["2", "3", "4"], correct: 1 }
            ]
        },
        {
            grade: 4, title: "THE_ANACRUSIS", 
            text: "An Anacrusis, or 'pickup note', is a note or sequence that precedes the first full measure. It establishes momentum before the 'downbeat'.",
            questions: [
                { q: "What is another name for an Anacrusis?", a: ["Downbeat", "Pickup", "Coda"], correct: 1 }
            ]
        },
        {
            grade: 5, title: "SYNCOPATION", 
            text: "Syncopation is the act of displacing the pulse by stressing the 'weak' beats or the spaces between beats. It is essential for jazz, funk, and modern rhythmic complexity.",
            questions: [
                { q: "Syncopation shifts the accent to which type of beat?", a: ["Strong Beat", "Weak Beat", "The Tactus"], correct: 1 }
            ]
        }
        // Syllabus continues through Grade 12...
    ];

    let userLevel = parseInt(localStorage.getItem('currentLevel')) || 1;
    let currentGradeInView = userLevel;
    let currentQuestionIndex = 0;

    function init() {
        const xp = localStorage.getItem('totalXP') || 0;
        document.getElementById('user-stats').innerText = `GRADE: ${userLevel.toString().padStart(2, '0')} // XP: ${xp}`;
        renderSidebar();
        loadGrade(currentGradeInView);
    }

    function renderSidebar() {
        const sidebar = document.getElementById('grade-sidebar');
        sidebar.innerHTML = SYLLABUS.map(g => {
            const isLocked = g.grade > userLevel;
            return `
                <div class="grade-item ${g.grade === currentGradeInView ? 'active' : ''} ${isLocked ? 'locked' : ''}" 
                     onclick="loadGrade(${g.grade})">
                    <span>${g.grade.toString().padStart(2, '0')} ${g.title}</span>
                    <span>${isLocked ? 'ðŸ”’' : 'âœ…'}</span>
                </div>
            `;
        }).join('');
    }

    function loadGrade(g) {
        if (g > userLevel) return;
        currentGradeInView = g;
        currentQuestionIndex = 0;
        renderSidebar();

        const data = SYLLABUS.find(item => item.grade === g);
        document.getElementById('lesson-title').innerText = data.title;
        document.getElementById('lesson-text').innerText = data.text;
        document.getElementById('btn-proceed').style.display = 'none';
        
        displayQuestion();
    }

    function displayQuestion() {
        const gradeData = SYLLABUS.find(item => item.grade === currentGradeInView);
        const qData = gradeData.questions[currentQuestionIndex];
        
        document.getElementById('question-text').innerText = `QUIZ: ${qData.q}`;
        const optionsArea = document.getElementById('options-area');
        optionsArea.innerHTML = '';

        qData.a.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(idx, qData.correct);
            optionsArea.appendChild(btn);
        });
    }

    function checkAnswer(selected, correct) {
        const btns = document.querySelectorAll('.option-btn');
        if (selected === correct) {
            btns[selected].classList.add('correct');
            
            const gradeData = SYLLABUS.find(item => item.grade === currentGradeInView);
            if (currentQuestionIndex < gradeData.questions.length - 1) {
                currentQuestionIndex++;
                setTimeout(displayQuestion, 800);
            } else {
                // If it's the current max level, show unlock button
                if (currentGradeInView === userLevel) {
                    document.getElementById('btn-proceed').style.display = 'block';
                }
            }
        } else {
            btns[selected].classList.add('wrong');
            setTimeout(() => btns[selected].classList.remove('wrong'), 500);
        }
    }

    function completeGrade() {
        if (userLevel < 12) {
            userLevel++;
            localStorage.setItem('currentLevel', userLevel);
            
            // Award XP
            let xp = parseInt(localStorage.getItem('totalXP') || 0);
            localStorage.setItem('totalXP', xp + 500);
            
            alert(`GRADE_${userLevel - 1} COMPLETED. NEURAL BRIDGE TO GRADE_${userLevel} STABILIZED.`);
            init();
        }
    }

    // AI Bot Logic
    document.getElementById('ai-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            const query = e.target.value.toLowerCase();
            const out = document.getElementById('ai-output');
            let response = "Data point not found. Query 'Tactus', 'Syncopation', or 'Anacrusis'.";

            if (query.includes("tactus")) response = "The Tactus is the heartbeat of the music. In Grade 1, we focus on quarter-note stability.";
            if (query.includes("triplet")) response = "Triplets belong to Grade 3 (Ternary Grouping). They divide a beat into three equal parts.";
            if (query.includes("syncopation")) response = "Syncopation (Grade 5) involves stressing the 'off-beat' or weak subdivisions.";

            out.innerText = `[AI]: ${response}`;
            e.target.value = '';
        }
    });

    window.onload = init;
</script>
</body>
</html>